<Window x:Class="DeliveryServiceManager.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="DeliveryService Manager" Height="600" Width="900"
        WindowStartupLocation="CenterScreen">

    <Grid>
        <TabControl>
            <!-- Вкладка для администратора -->
            <TabItem x:Name="tabAdmin" Header="Клиенты" Visibility="Collapsed">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Панель добавления клиента -->
                    <GroupBox Header="Добавить клиента" Grid.Row="0" Margin="0,0,0,10">
                        <StackPanel Margin="5">
                            <TextBlock Text="ФИО:"/>
                            <TextBox x:Name="txtClientName" Margin="0,0,0,10"/>

                            <TextBlock Text="Телефон:"/>
                            <TextBox x:Name="txtClientPhone" Margin="0,0,0,10"/>

                            <TextBlock Text="Адрес:"/>
                            <TextBox x:Name="txtClientAddress" Margin="0,0,0,10"/>

                            <Button Content="Добавить" Click="AddClient_Click" Width="100"/>
                        </StackPanel>
                    </GroupBox>

                    <!-- Список клиентов -->
                    <DataGrid x:Name="dgClients" Grid.Row="1" AutoGenerateColumns="False"
                              CanUserAddRows="False" CanUserDeleteRows="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                            <DataGridTextColumn Header="ФИО" Binding="{Binding FullName}" Width="200"/>
                            <DataGridTextColumn Header="Телефон" Binding="{Binding Phone}" Width="150"/>
                            <DataGridTextColumn Header="Адрес" Binding="{Binding Address}" Width="300"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Кнопки управления -->
                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,0">
                        <Button Content="Удалить выбранного" Click="DeleteClient_Click" 
                                Margin="0,0,10,0"/>
                        <Button Content="Обновить" Click="RefreshClients_Click"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- Вкладка заказов -->
            <TabItem Header="Заказы">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Панель создания заказа (только для админа) -->
                    <GroupBox x:Name="gbNewOrder" Header="Создать заказ" Grid.Row="0" 
                              Margin="0,0,0,10" Visibility="Collapsed">
                        <Grid Margin="5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="10"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Клиент:"/>
                                <ComboBox x:Name="cmbClients" DisplayMemberPath="FullName" 
                                          Margin="0,0,0,10"/>

                                <TextBlock Text="Товары (через запятую):"/>
                                <TextBox x:Name="txtProducts" Height="60" 
                                         TextWrapping="Wrap" AcceptsReturn="True"
                                         Margin="0,0,0,10"/>
                            </StackPanel>

                            <StackPanel Grid.Column="2">
                                <TextBlock Text="Сумма:"/>
                                <TextBox x:Name="txtTotalPrice" Margin="0,0,0,10"/>

                                <Button Content="Создать заказ" Click="CreateOrder_Click" 
                                        Margin="0,10,0,0" Height="30"/>
                            </StackPanel>
                        </Grid>
                    </GroupBox>

                    <!-- Список заказов -->
                    <DataGrid x:Name="dgOrders" Grid.Row="1" AutoGenerateColumns="False"
                              CanUserAddRows="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                            <DataGridTextColumn Header="Клиент" Binding="{Binding ClientName}" Width="150"/>
                            <DataGridTextColumn Header="Товары" Binding="{Binding Products}" Width="250"/>
                            <DataGridTextColumn Header="Сумма" Binding="{Binding TotalPrice, StringFormat=C}" Width="100"/>
                            <DataGridTextColumn Header="Статус" Binding="{Binding Status}" Width="100"/>
                            <DataGridTextColumn Header="Дата" Binding="{Binding Date, StringFormat=dd.MM.yyyy}" Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Панель для курьера -->
                    <StackPanel x:Name="spCourier" Grid.Row="2" Orientation="Horizontal" 
                                Margin="0,10,0,0" Visibility="Collapsed">
                        <TextBlock Text="Изменить статус на:" VerticalAlignment="Center" 
                                   Margin="0,0,10,0"/>
                        <ComboBox x:Name="cmbStatus" Width="120" Margin="0,0,10,0">
                            <ComboBoxItem Content="В процессе"/>
                            <ComboBoxItem Content="Доставлен"/>
                            <ComboBoxItem Content="Отменён"/>
                        </ComboBox>
                        <Button Content="Обновить" Click="UpdateStatus_Click"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- Вкладка статистики (только для админа) -->
            <TabItem x:Name="tabStats" Header="Статистика" Visibility="Collapsed">
                <Grid Margin="20">
                    <StackPanel>
                        <TextBlock Text="Статистика" FontSize="20" FontWeight="Bold" 
                                   Margin="0,0,0,20"/>

                        <GroupBox Header="Общая статистика" Margin="0,0,0,10">
                            <StackPanel Margin="10">
                                <TextBlock>
                                    <Run Text="Всего заказов:" FontWeight="Bold"/>
                                    <Run x:Name="runTotalOrders"/>
                                </TextBlock>

                                <TextBlock Margin="0,5,0,0">
                                    <Run Text="Общая выручка:" FontWeight="Bold"/>
                                    <Run x:Name="runTotalRevenue"/>
                                </TextBlock>

                                <TextBlock Margin="0,5,0,0">
                                    <Run Text="Активных клиентов:" FontWeight="Bold"/>
                                    <Run x:Name="runActiveClients"/>
                                </TextBlock>
                            </StackPanel>
                        </GroupBox>

                        <GroupBox Header="Экспорт отчетов" Margin="0,10,0,0">
                            <StackPanel Margin="10">
                                <Button Content="Экспорт в JSON" Click="ExportJson_Click" 
                                        Margin="0,0,0,5"/>
                                <Button Content="Экспорт в CSV" Click="ExportCsv_Click"/>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</Window>